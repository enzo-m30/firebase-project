<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="styles/styles.css">
  <title>Your Portfolio</title>

  <script type="module" defer>
    // Import Firebase SDKs
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.2/firebase-app.js";
    import { getFirestore, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/10.7.2/firebase-firestore.js";
    import firebaseConfig from "./config.js";

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Handle form submission
    document.addEventListener('DOMContentLoaded', () => {
      const form = document.getElementById('addProjectForm');
      const projectsList = document.getElementById('projectsList');

      form.addEventListener('submit', async (event) => {
        event.preventDefault();

        const title = document.getElementById('title').value.trim();
        const description = document.getElementById('description').value.trim();

        if (!title || !description) {
          alert('Please fill out both fields.');
          return;
        }

        try {
          const docRef = await addDoc(collection(db, 'projects'), {
            title: title,
            description: description
          });
          console.log('Project added with ID:', docRef.id);
          alert('✅ Project added successfully!');
          form.reset();
          fetchProjects();
        } catch (error) {
          console.error('Error adding project:', error);
          alert('❌ Error adding project. Check the console for details.');
        }
      });

      // Fetch and display projects
      async function fetchProjects() {
        try {
          const querySnapshot = await getDocs(collection(db, 'projects'));
          projectsList.innerHTML = '';
          querySnapshot.forEach((doc) => {
            const project = doc.data();
            const listItem = document.createElement('li');
            listItem.textContent = `${project.title}: ${project.description}`;
            projectsList.appendChild(listItem);
          });
        } catch (error) {
          console.error('Error getting projects:', error);
        }
      }

      // Initial fetch
      fetchProjects();
    });
  </script>
</head>

<body>
  <header>
    <nav>
      <a href="projects.html">Projects - No login</a>
      <a href="cr.html">Create and Read</a>
      <a href="crd.html">Create, Read, and Delete</a>
      <a href="crud.html">Create, Read, Update, and Delete</a>
    </nav>
  </header>

  <div id="projects-container">
    <h1>Add Project</h1>
    <form id="addProjectForm">
      <label for="title">Project Name:</label>
      <input type="text" id="title" name="title" required><br>

      <label for="description">Project Description:</label>
      <textarea id="description" name="description" required></textarea><br>

      <button type="submit">Add Project</button>
    </form>

    <h2>Projects</h2>
    <ul id="projectsList"></ul>
  </div>
</body>
</html>
